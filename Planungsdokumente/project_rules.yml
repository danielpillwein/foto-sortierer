version: 1
project: FotoSortierer
description: >
  Persistente KI-Regeln für das Projekt FotoSortierer. 
  Grundlage sind die Projektplanung und der Master System Prompt.

# ---------------------------------------------------------
# 1) Globale KI-Regeln (Level 1 – Strong)
# ---------------------------------------------------------
rules:
  - name: projektstruktur_einhalten
    description: >
      Alle Vorschläge und Code müssen in die bestehende Struktur integriert werden.
    enforce:
      - use_existing_modules_only: true
      - no_duplicate_modules: true
      - allow_new_module_only_if_required: true
      - structure:
          - core/
          - ui/
          - scripts/
          - assets/
          - cache/
          - data/
          - logs/

  - name: performance_priorisieren
    description: >
      Jede Lösung muss Performance maximieren.
    enforce:
      - lazy_loading: true
      - multithreading: ThreadPoolExecutor
      - caching:
          disk_cache: true
          json_cache: true
      - exif_library: piexif
      - dupe_detection: imagehash_pHash
      - qt_optimization: true

  - name: antwortstil
    description: >
      Präzise, technischer Stil, keine Füllwörter.
    enforce:
      - no_bla_bla: true
      - always_project_related: true
      - ask_if_information_missing: true
      - markdown_format: obsidian
      - minimal_code: true
      - no_redundancy: true

  - name: ui_ux_vorgaben
    description: >
      Regeln für die FotoSortierer Benutzeroberfläche.
    enforce:
      - toolkit: PyQt6
      - design:
          clear_layout: true
          reduced_ui: true
          prominent_progress_bar: true
          grouped_controls: true
      - components:
          - sorter_view
          - dupe_checker
          - exif_editor
      - hotkeys_visible: true
      - fullscreen_sorter_default: true

  - name: architektur
    description: >
      Regeln für modulare und wartbare Architektur.
    enforce:
      - oop: true
      - single_responsibility: true
      - use_core_managers:
          - file_manager
          - media_loader
          - duplicate_detector
          - session_manager
          - config_manager
      - no_logic_in_ui: true
      - prefer_new_manager_over_inline_logic: true

  - name: kein_totes_wissen
    description: >
      Kein ungenutzter Code, keine Alternativen, die nicht integriert werden.
    enforce:
      - no_dead_code: true
      - no_unused_modules: true
      - no_external_architectures: true

# ---------------------------------------------------------
# 2) Projektkontext (automatisch verfügbar)
# ---------------------------------------------------------
project_context:
  goals:
    - Hochperformanter Medien-Sorter
    - Lazy Loading + Multithreading
    - Dublettenerkennung via pHash
    - EXIF-Lesen und -Schreiben
    - Stabile PyQt6-Oberfläche
    - Persistente Sitzungen
    - Testdatengenerator
    - Konsistente Dokumentation
  features:
    - Vollständige Medienanzeige (Bilder, GIF, WebP, Videos)
    - EXIF-Auswertung und -Änderung
    - Multithreaded Lazy Loader
    - pHash Dublettenerkennung
    - Fortschrittsanzeige über gesamten Bildschirm
    - Testdaten-Generator-Script
  references:
    - projektdatei: Projektplanung.md
    - master_prompt: Master_System_Prompt.md

# ---------------------------------------------------------
# 3) Modulzuordnung
# ---------------------------------------------------------
module_map:
  core:
    - file_manager
    - metadata_extractor
    - exif_manager
    - duplicate_detector
    - session_manager
    - media_loader
    - progress_tracker
    - cache_manager
    - config_manager
  ui:
    - main_window
    - sorter_view
    - dupe_checker
    - exif_editor
  scripts:
    - test_data_generator
  data:
    - sessions.json
    - config.json
  cache:
    - thumbnails/
    - hash_cache.json
    - exif_cache.json

# ---------------------------------------------------------
# 4) KI-Verhalten im Arbeitsmodus Antigravity
# ---------------------------------------------------------
antigravity_behavior:
  map_suggestions_to_files: true
  specify_file_location_in_every_answer: true
  request_missing_info: true
  require_micro_diff_tables: optional
  respect_project_architecture: strict
  always_use_master_system_prompt: true

# ---------------------------------------------------------
# 5) Antwort-Template
# ---------------------------------------------------------
response_template:
  - "1) Lösung / Änderung / Vorschlag"
  - "2) Platzierung in Projektstruktur"
  - "3) Warum diese Lösung?"
  - "4) Optional: Minimaler Code-Ausschnitt"
  - "5) Rückfragen"

# ---------------------------------------------------------
# 6) Sicherheitsregeln
# ---------------------------------------------------------
safe_guards:
  - never_add_features_not_in_project_plan
  - always_follow_phase_structure
  - maintain_cross_file_consistency
  - optimize_for_build_with_pyinstaller
